<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Music Player</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      overflow-x: hidden;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }

    #app {
      min-height: 100vh;
      background: var(--tg-theme-bg-color, #ffffff);
      color: var(--tg-theme-text-color, #000000);
      padding-bottom: 140px;
    }

    .header {
      padding: 20px;
      text-align: center;
      background: var(--tg-theme-secondary-bg-color, #f5f5f5);
      border-bottom: 1px solid var(--tg-theme-section-separator-color, #e5e5e5);
    }

    .header h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .header p {
      font-size: 14px;
      opacity: 0.6;
    }

    .track-list {
      padding: 10px;
    }

    .track-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 8px;
      background: var(--tg-theme-secondary-bg-color, #f5f5f5);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
      gap: 12px;
    }

    .track-item:active {
      transform: scale(0.98);
      opacity: 0.8;
    }

    .track-item.active {
      background: var(--tg-theme-button-color, #3390ec);
      color: var(--tg-theme-button-text-color, #ffffff);
    }

    .track-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      background: linear-gradient(135deg, var(--tg-theme-button-color, #3390ec), var(--tg-theme-link-color, #2481cc));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      flex-shrink: 0;
    }

    .track-info {
      flex: 1;
      min-width: 0;
    }

    .track-title {
      font-weight: 600;
      font-size: 15px;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .track-artist {
      font-size: 13px;
      opacity: 0.6;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .track-duration {
      font-size: 13px;
      opacity: 0.5;
      flex-shrink: 0;
    }

    .player {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--tg-theme-secondary-bg-color, #f5f5f5);
      border-top: 1px solid var(--tg-theme-section-separator-color, #e5e5e5);
      padding: 15px 20px 25px;
      backdrop-filter: blur(20px);
      box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
    }

    .player-info {
      text-align: center;
      margin-bottom: 15px;
    }

    .player-title {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 4px;
    }

    .player-artist {
      font-size: 13px;
      opacity: 0.6;
    }

    .progress-container {
      margin-bottom: 15px;
    }

    .progress-bar {
      width: 100%;
      height: 4px;
      background: var(--tg-theme-hint-color, #999999);
      border-radius: 2px;
      overflow: hidden;
      cursor: pointer;
      margin-bottom: 8px;
    }

    .progress-fill {
      height: 100%;
      background: var(--tg-theme-button-color, #3390ec);
      transition: width 0.1s linear;
    }

    .progress-time {
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      opacity: 0.5;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
    }

    .control-btn {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: var(--tg-theme-button-color, #3390ec);
      color: var(--tg-theme-button-text-color, #ffffff);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 20px;
    }

    .control-btn:active {
      transform: scale(0.9);
    }

    .control-btn.play-btn {
      width: 60px;
      height: 60px;
      font-size: 28px;
    }

    .control-btn.small {
      width: 40px;
      height: 40px;
      font-size: 18px;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .playing-indicator {
      display: inline-block;
      animation: pulse 1.5s ease-in-out infinite;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="header">
      <h1>üéµ Music Player</h1>
      <p>{{ tracks.length }} —Ç—Ä–µ–∫–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ</p>
    </div>

    <div class="track-list">
      <div 
        v-for="(track, index) in tracks" 
        :key="index"
        class="track-item"
        :class="{ active: currentTrackIndex === index }"
        @click="playTrack(index)"
      >
        <div class="track-cover">{{ track.emoji }}</div>
        <div class="track-info">
          <div class="track-title">
            <span v-if="currentTrackIndex === index && isPlaying" class="playing-indicator">‚ñ∂</span>
            {{ track.title }}
          </div>
          <div class="track-artist">{{ track.artist }}</div>
        </div>
        <div class="track-duration">{{ track.duration }}</div>
      </div>
    </div>

    <div class="player" v-if="currentTrack">
      <div class="player-info">
        <div class="player-title">{{ currentTrack.title }}</div>
        <div class="player-artist">{{ currentTrack.artist }}</div>
      </div>

      <div class="progress-container">
        <div class="progress-bar" @click="seek">
          <div class="progress-fill" :style="{ width: progress + '%' }"></div>
        </div>
        <div class="progress-time">
          <span>{{ formatTime(currentTime) }}</span>
          <span>{{ currentTrack.duration }}</span>
        </div>
      </div>

      <div class="controls">
        <button class="control-btn small" @click="previousTrack">‚èÆ</button>
        <button class="control-btn play-btn" @click="togglePlay">
          {{ isPlaying ? '‚è∏' : '‚ñ∂' }}
        </button>
        <button class="control-btn small" @click="nextTrack">‚è≠</button>
      </div>
    </div>

    <audio ref="audio" @timeupdate="updateProgress" @ended="nextTrack"></audio>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          tracks: [
            { title: '–õ–µ—Ç–Ω–∏–π –≤–µ—á–µ—Ä', artist: 'Indie Wave', duration: '3:45', emoji: 'üåÖ', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3' },
            { title: '–ì–æ—Ä–æ–¥—Å–∫–∏–µ –æ–≥–Ω–∏', artist: 'Night Riders', duration: '4:12', emoji: 'üåÉ', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3' },
            { title: '–ú–æ—Ä—Å–∫–æ–π –±—Ä–∏–∑', artist: 'Ocean Dreams', duration: '3:28', emoji: 'üåä', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3' },
            { title: '–ó–≤–µ–∑–¥–Ω–∞—è –Ω–æ—á—å', artist: 'Cosmic Flow', duration: '5:01', emoji: '‚ú®', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3' },
            { title: '–†–∞—Å—Å–≤–µ—Ç', artist: 'Morning Light', duration: '3:56', emoji: 'üåÑ', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3' },
            { title: '–î–æ–∂–¥–ª–∏–≤—ã–π –¥–µ–Ω—å', artist: 'Autumn Mood', duration: '4:33', emoji: 'üåß', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3' },
          ],
          currentTrackIndex: 0,
          isPlaying: false,
          currentTime: 0,
          progress: 0
        };
      },
      computed: {
        currentTrack() {
          return this.tracks[this.currentTrackIndex];
        }
      },
      methods: {
        playTrack(index) {
          this.currentTrackIndex = index;
          const audio = this.$refs.audio;
          audio.src = this.currentTrack.url;
          audio.play();
          this.isPlaying = true;
        },
        togglePlay() {
          const audio = this.$refs.audio;
          if (this.isPlaying) {
            audio.pause();
          } else {
            if (!audio.src) {
              audio.src = this.currentTrack.url;
            }
            audio.play();
          }
          this.isPlaying = !this.isPlaying;
        },
        nextTrack() {
          this.currentTrackIndex = (this.currentTrackIndex + 1) % this.tracks.length;
          const audio = this.$refs.audio;
          audio.src = this.currentTrack.url;
          audio.play();
          this.isPlaying = true;
        },
        previousTrack() {
          this.currentTrackIndex = this.currentTrackIndex === 0 ? this.tracks.length - 1 : this.currentTrackIndex - 1;
          const audio = this.$refs.audio;
          audio.src = this.currentTrack.url;
          audio.play();
          this.isPlaying = true;
        },
        updateProgress() {
          const audio = this.$refs.audio;
          this.currentTime = audio.currentTime;
          this.progress = (audio.currentTime / audio.duration) * 100 || 0;
        },
        seek(event) {
          const audio = this.$refs.audio;
          const progressBar = event.currentTarget;
          const clickX = event.offsetX;
          const width = progressBar.offsetWidth;
          const duration = audio.duration;
          audio.currentTime = (clickX / width) * duration;
        },
        formatTime(seconds) {
          const mins = Math.floor(seconds / 60);
          const secs = Math.floor(seconds % 60);
          return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
      },
      mounted() {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        if (window.Telegram?.WebApp) {
          const tg = window.Telegram.WebApp;
          tg.ready();
          tg.expand();
          
          // –†–∞–∑—Ä–µ—à–∞–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ
          tg.enableClosingConfirmation();
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–≤—ã–π —Ç—Ä–µ–∫
        this.$refs.audio.src = this.currentTrack.url;
      }
    }).mount('#app');
  </script>
</body>
</html>
